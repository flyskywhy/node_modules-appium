'use strict';

var _regeneratorRuntime = require('babel-runtime/regenerator')['default'];

var _interopRequireDefault = require('babel-runtime/helpers/interop-require-default')['default'];

Object.defineProperty(exports, '__esModule', {
  value: true
});

var _appiumBaseDriver = require('appium-base-driver');

var _logger = require('../logger');

var _logger2 = _interopRequireDefault(_logger);

var _utils = require('../utils');

var commands = {};

commands.updateSettings = function callee$0$0(newSettings) {
  return _regeneratorRuntime.async(function callee$0$0$(context$1$0) {
    while (1) switch (context$1$0.prev = context$1$0.next) {
      case 0:
        if (!this.settings) {
          _logger2['default'].errorAndThrow('Cannot update settings; settings object not found');
        }
        return context$1$0.abrupt('return', this.settings.update(newSettings));

      case 2:
      case 'end':
        return context$1$0.stop();
    }
  }, null, this);
};

commands.getSettings = function callee$0$0() {
  return _regeneratorRuntime.async(function callee$0$0$(context$1$0) {
    while (1) switch (context$1$0.prev = context$1$0.next) {
      case 0:
        if (!this.settings) {
          _logger2['default'].errorAndThrow('Cannot get settings; settings object not found');
        }
        return context$1$0.abrupt('return', this.settings.getSettings());

      case 2:
      case 'end':
        return context$1$0.stop();
    }
  }, null, this);
};

// Amplifies time on the device by a factor
// examples:
// 2 = twice the speed
// 1 = normal speed
// 0.5 = half the speed
commands.setTimeDilation = function callee$0$0(factor) {
  var commandObject, commandJSON, data, result;
  return _regeneratorRuntime.async(function callee$0$0$(context$1$0) {
    while (1) switch (context$1$0.prev = context$1$0.next) {
      case 0:
        commandObject = {
          name: 'setTimeDilation',
          args: ['' + factor]
        };
        commandJSON = JSON.stringify(commandObject);
        context$1$0.next = 4;
        return _regeneratorRuntime.awrap(this.executeSocketCommand(commandJSON));

      case 4:
        data = context$1$0.sent;
        result = undefined;
        context$1$0.prev = 6;

        result = JSON.parse(data);
        context$1$0.next = 13;
        break;

      case 10:
        context$1$0.prev = 10;
        context$1$0.t0 = context$1$0['catch'](6);
        throw new Error("Bad response from setValue");

      case 13:
        if (!(result.status === _utils.youiEngineDriverReturnValues.WEBDRIVER_UNKNOWN_COMMAND)) {
          context$1$0.next = 15;
          break;
        }

        throw new _appiumBaseDriver.errors.UnknownCommandError('argument must be numeric and larger than zero');

      case 15:
        return context$1$0.abrupt('return', result.value);

      case 16:
      case 'end':
        return context$1$0.stop();
    }
  }, null, this, [[6, 10]]);
};

exports['default'] = commands;
module.exports = exports['default'];
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi9jb21tYW5kcy9zZXR0aW5ncy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O2dDQUF1QixvQkFBb0I7O3NCQUMzQixXQUFXOzs7O3FCQUNrQixVQUFVOztBQUV2RCxJQUFJLFFBQVEsR0FBRyxFQUFFLENBQUM7O0FBRWxCLFFBQVEsQ0FBQyxjQUFjLEdBQUcsb0JBQWdCLFdBQVc7Ozs7QUFDbkQsWUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUU7QUFDbEIsOEJBQUksYUFBYSxDQUFDLG1EQUFtRCxDQUFDLENBQUM7U0FDeEU7NENBQ00sSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsV0FBVyxDQUFDOzs7Ozs7O0NBQ3pDLENBQUM7O0FBRUYsUUFBUSxDQUFDLFdBQVcsR0FBRzs7OztBQUNyQixZQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsRUFBRTtBQUNsQiw4QkFBSSxhQUFhLENBQUMsZ0RBQWdELENBQUMsQ0FBQztTQUNyRTs0Q0FDTSxJQUFJLENBQUMsUUFBUSxDQUFDLFdBQVcsRUFBRTs7Ozs7OztDQUNuQyxDQUFDOzs7Ozs7O0FBT0YsUUFBUSxDQUFDLGVBQWUsR0FBRyxvQkFBZ0IsTUFBTTtNQUMzQyxhQUFhLEVBSWIsV0FBVyxFQUNYLElBQUksRUFFSixNQUFNOzs7O0FBUE4scUJBQWEsR0FBRztBQUNsQixjQUFJLG1CQUFtQjtBQUN2QixjQUFJLEVBQUUsTUFBSSxNQUFNLENBQUc7U0FDcEI7QUFDRyxtQkFBVyxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsYUFBYSxDQUFDOzt5Q0FDOUIsSUFBSSxDQUFDLG9CQUFvQixDQUFDLFdBQVcsQ0FBQzs7O0FBQW5ELFlBQUk7QUFFSixjQUFNOzs7QUFFUixjQUFNLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQzs7Ozs7OztjQUVwQixJQUFJLEtBQUssQ0FBQyw0QkFBNEIsQ0FBQzs7O2NBRzNDLE1BQU0sQ0FBQyxNQUFNLEtBQUssb0NBQTZCLHlCQUF5QixDQUFBOzs7OztjQUNwRSxJQUFJLHlCQUFPLG1CQUFtQixDQUFDLCtDQUErQyxDQUFDOzs7NENBR2hGLE1BQU0sQ0FBQyxLQUFLOzs7Ozs7O0NBQ3BCLENBQUM7O3FCQUVhLFFBQVEiLCJmaWxlIjoibGliL2NvbW1hbmRzL3NldHRpbmdzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZXJyb3JzIH0gZnJvbSAnYXBwaXVtLWJhc2UtZHJpdmVyJztcbmltcG9ydCBsb2cgZnJvbSAnLi4vbG9nZ2VyJztcbmltcG9ydCB7IHlvdWlFbmdpbmVEcml2ZXJSZXR1cm5WYWx1ZXMgfSBmcm9tICcuLi91dGlscyc7XG5cbmxldCBjb21tYW5kcyA9IHt9O1xuXG5jb21tYW5kcy51cGRhdGVTZXR0aW5ncyA9IGFzeW5jIGZ1bmN0aW9uIChuZXdTZXR0aW5ncykge1xuICBpZiAoIXRoaXMuc2V0dGluZ3MpIHtcbiAgICBsb2cuZXJyb3JBbmRUaHJvdygnQ2Fubm90IHVwZGF0ZSBzZXR0aW5nczsgc2V0dGluZ3Mgb2JqZWN0IG5vdCBmb3VuZCcpO1xuICB9XG4gIHJldHVybiB0aGlzLnNldHRpbmdzLnVwZGF0ZShuZXdTZXR0aW5ncyk7XG59O1xuXG5jb21tYW5kcy5nZXRTZXR0aW5ncyA9IGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgaWYgKCF0aGlzLnNldHRpbmdzKSB7XG4gICAgbG9nLmVycm9yQW5kVGhyb3coJ0Nhbm5vdCBnZXQgc2V0dGluZ3M7IHNldHRpbmdzIG9iamVjdCBub3QgZm91bmQnKTtcbiAgfVxuICByZXR1cm4gdGhpcy5zZXR0aW5ncy5nZXRTZXR0aW5ncygpO1xufTtcblxuLy8gQW1wbGlmaWVzIHRpbWUgb24gdGhlIGRldmljZSBieSBhIGZhY3RvclxuLy8gZXhhbXBsZXM6IFxuLy8gMiA9IHR3aWNlIHRoZSBzcGVlZFxuLy8gMSA9IG5vcm1hbCBzcGVlZFxuLy8gMC41ID0gaGFsZiB0aGUgc3BlZWQgXG5jb21tYW5kcy5zZXRUaW1lRGlsYXRpb24gPSBhc3luYyBmdW5jdGlvbiAoZmFjdG9yKSB7XG4gIHZhciBjb21tYW5kT2JqZWN0ID0ge1xuICAgIG5hbWU6IGBzZXRUaW1lRGlsYXRpb25gLFxuICAgIGFyZ3M6IFtgJHtmYWN0b3J9YF1cbiAgfTtcbiAgdmFyIGNvbW1hbmRKU09OID0gSlNPTi5zdHJpbmdpZnkoY29tbWFuZE9iamVjdCk7XG4gIGxldCBkYXRhID0gYXdhaXQgdGhpcy5leGVjdXRlU29ja2V0Q29tbWFuZChjb21tYW5kSlNPTik7XG4gIFxuICBsZXQgcmVzdWx0O1xuICB0cnkge1xuICAgIHJlc3VsdCA9IEpTT04ucGFyc2UoZGF0YSk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJCYWQgcmVzcG9uc2UgZnJvbSBzZXRWYWx1ZVwiKTtcbiAgfVxuICBcbiAgaWYgKHJlc3VsdC5zdGF0dXMgPT09IHlvdWlFbmdpbmVEcml2ZXJSZXR1cm5WYWx1ZXMuV0VCRFJJVkVSX1VOS05PV05fQ09NTUFORCkge1xuICAgIHRocm93IG5ldyBlcnJvcnMuVW5rbm93bkNvbW1hbmRFcnJvcignYXJndW1lbnQgbXVzdCBiZSBudW1lcmljIGFuZCBsYXJnZXIgdGhhbiB6ZXJvJyk7XG4gIH1cbiAgXG4gIHJldHVybiByZXN1bHQudmFsdWU7XG59O1xuXG5leHBvcnQgZGVmYXVsdCBjb21tYW5kcztcbiJdLCJzb3VyY2VSb290IjoiLi4vLi4vLi4ifQ==
